#!/usr/bin/env ruby

$LOAD_PATH << File.expand_path(File.dirname(__FILE__) + '/../lib')
require 'ml'

puts "generating points"
line = [-1.0, 2.0, 0.0]
generator = ML::Generator2D.new
data = generator.points_2d(100, line)

puts "training line"
supervised = {}
data[0].each { |e| supervised[e] = 1 }
data[1].each { |e| supervised[e] = -1 }
learner = ML::PerceptronLearner.new(2)
learner.train! supervised
puts "training done"

line_points = []
line_points << ML::Generator2D.point_from_line(learner.line, 0)
line_points << ML::Generator2D.point_from_line(learner.line, 100)

orig_line_points = []
orig_line_points << ML::Generator2D.point_from_line(line, 0)
orig_line_points << ML::Generator2D.point_from_line(line, 100)

puts "plotting points"

graph = ML::Plotter.new(100, 100, 400, 400) do |p|
  p.dot data[0], "cross"
  p.dot data[1], "circle"
  p.line line_points, "#f00"
  p.line orig_line_points, "#0f0"
end

puts "saving file"
File.open(ARGV[0], "w") do |f|
  f.write graph.to_svg
end
