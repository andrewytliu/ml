#!/usr/bin/env ruby

$LOAD_PATH << File.expand_path(File.dirname(__FILE__) + '/../lib')
require 'ml'

puts "generating points"
line = [-1.0, 2.0, 0.0]
generator = ML::Generator.new
data = generator.points_2d(10, line)

puts "training line"
supervised = {}
data[0].each { |e| supervised[e] = 1 }
data[1].each { |e| supervised[e] = -1 }
learner = ML::PerceptronLearner.new(2)
learner.train! supervised
puts "training done"

line_points = []
line_points << ML::Generator.point_from_line(learner.line, 0)
line_points << ML::Generator.point_from_line(learner.line, 100)

puts "plotting points"

# graph = ML::Plotter.new(100, 100, 400, 400) do |p|
#   # puts "dot"
#   # p data[0]
#   # p data[1]
#   # p.dot data[0], "cross"
#   #p.dot data[1], "circle"
#   # puts "line"
#   p line_points
#   p.line line_points
# end
plotter = ML::Plotter.new(100, 100, 400, 400)


puts "saving file"
File.open(ARGV[0], "w") do |f|
  # f.write graph.to_svg
  f.write plotter.plot data, line_points
end
